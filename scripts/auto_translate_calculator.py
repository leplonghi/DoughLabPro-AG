import os
import json
import re

def load_json(path):
    with open(path, 'r', encoding='utf-8') as f:
        return json.load(f)

def save_json(path, data):
    with open(path, 'w', encoding='utf-8') as f:
        json.dump(data, f, indent=2, ensure_ascii=False)

# COMMON DICTIONARIES
COMMON_PT = {
    "Easy": "Fácil",
    "Medium": "Médio",
    "Hard": "Difícil",
    "Expert": "Especialista",
    "Mix": "Mistura",
    "Prep": "Preparo",
    "Bake": "Assar",
    "Bulk": "Fermentação em Bloco",
    "Proof": "Fermentação Final (Appret)",
    "Cold": "Frio",
    "Type": "Tipo",
    "Temp": "Temp",
    "Flour": "Farinha",
    "Water": "Água",
    "Salt": "Sal",
    "Yeast": "Fermento",
    "Sugar": "Açúcar",
    "Oil": "Óleo",
    "Fat": "Gordura",
    "Milk": "Leite",
    "Butter": "Manteiga",
    "Eggs": "Ovos",
    "Egg": "Ovo",
    "Whole Egg": "Ovo Inteiro",
    "Whole Eggs": "Ovos Inteiros",
    "Eggy Wash": "Egg Wash",
    "Sourdough": "Levain",
    "Poolish": "Poolish",
    "Biga": "Biga",
    "Sponge": "Esponja",
    "Autolyse": "Autólise",
    "Tangzhong": "Tangzhong",
    "Yudane": "Yudane",
    "Pre-ferment": "Pré-fermento",
    "Leavening": "Fermentação",
    "Direct": "Direto",
    "Indirect": "Indireto",
    "Hybrid": "Híbrido",
    "USA": "EUA",
    "Italy": "Itália",
    "France": "França",
    "Germany": "Alemanha",
    "Spain": "Espanha",
    "Brazil": "Brasil",
    "Japan": "Japão",
    "Mexico": "México",
    "China": "China",
    "India": "Índia",
    "Ireland": "Irlanda",
    "Netherlands": "Países Baixos",
    "Denmark": "Dinamarca",
    "Norway": "Noruega",
    "Europe": "Europa",
    "Asia": "Ásia",
    "Global": "Global",
    "Traditional": "Tradicional",
    "Modern": "Moderno",
    "Authentic": "Autêntico",
    "Standard": "Padrão",
    "Classic": "Clássico",
    "Custom": "Personalizado",
    "Unknown": "Desconhecido",
    "Balanced": "Equilibrado",
    "Soft": "Macio",
    "Crispy": "Crocante",
    "Crunchy": "Crocante",
    "Chewy": "Borrachudo",
    "Dense": "Denso",
    "Light": "Leve",
    "Airy": "Aerado",
    "High": "Alto",
    "Low": "Baixo",
    "Normal": "Normal",
    "Rich": "Rico",
    "Lean": "Magro",
    "Sweet": "Doce",
    "Salty": "Salgado",
    "Sour": "Azedo",
    "Bitter": "Amargo",
    "Savory": "Salgado/Saboroso",
    "Steam": "Vapor",
    "Convection": "Convecção",
    "Conduction": "Condução",
    "Radiant": "Radiante",
    "Lye": "Soda Cáustica",
    "Breakfast": "Café da Manhã",
    "Snack": "Lanche",
    "Dinner": "Jantar",
    "Lunch": "Almoço",
    "Dessert": "Sobremesa",
    "Bread": "Pão",
    "Pizza": "Pizza",
    "Flatbread": "Pão Achatado",
    "Pastry": "Confeitaria",
    "Bun": "Pãozinho",
    "Roll": "Rolinho",
    "Loaf": "Fornada/Pão",
    "Baguette": "Baguete",
    "Brioche": "Brioche",
    "Croissant": "Croissant",
    "Focaccia": "Focaccia",
    "Panettone": "Panetone",
    "Stollen": "Stollen",
    "Donut": "Donut",
    "Cookie": "Cookie",
    "Cake": "Bolo",
    "Brownie": "Brownie",
    "Pita": "Pita",
    "Naan": "Naan",
    "Tortilla": "Tortilha",
    "Bagel": "Bagel",
    "Pretzel": "Pretzel",
    "Soda Bread": "Pão de Soda",
    "Tiger Bread": "Pão Tigre",
    "Rye": "Centeio",
    "Wheat": "Trigo",
    "Whole Wheat": "Trigo Integral",
    "White": "Branco",
    "Corn": "Milho",
    "Potato": "Batata",
    "Rice": "Arroz",
    "Semolina": "Semolina",
    "Durum": "Durum",
    "Spelt": "Espelta",
    "High Gluten": "Alto Glúten",
    "All Purpose": "Uso Geral",
    "Bread Flour": "Farinha de Pão",
    "Cake Flour": "Farinha de Bolo",
    "Pastry Flour": "Farinha de Confeitaria",
    "Strong": "Forte",
    "Weak": "Fraca",
    "Active": "Ativo",
    "Inactive": "Inativo",
    "Fresh": "Fresco",
    "Dry": "Seco",
    "Instant": "Instantâneo",
    "Liquid": "Líquido",
    "Solid": "Sólido",
    "History": "História",
    "Science": "Ciência",
    "Origin": "Origem",
    "Description": "Descrição",
    "Instructions": "Instruções",
    "Notes": "Notas",
    "Tips": "Dicas",
    "Warnings": "Avisos", 
    "Ingredients": "Ingredientes",
    "Method": "Método",
    "Process": "Processo",
    "Time": "Tempo",
    "Temperature": "Temperatura",
    "Tools": "Ferramentas",
    "Equipment": "Equipamento",
    "Total": "Total",
    "Yield": "Rendimento",
    "Servings": "Porções",
    "Author": "Autor",
    "Source": "Fonte",
    "Reference": "Referência",
    "None": "Nenhum",
    "Optional": "Opcional",
    "Required": "Obrigatório",
    "Recommended": "Recomendado",
    "Forbidden": "Proibido",
    "Ideal": "Ideal",
    "General": "Geral",
    "Specific": "Específico",
    "Other": "Outro",
    "More": "Mais",
    "Less": "Menos",
    "About": "Sobre",
    "Contact": "Contato",
    "Help": "Ajuda",
    "Settings": "Configurações",
    "Profile": "Perfil",
    "Account": "Conta",
    "Login": "Entrar",
    "Logout": "Sair",
    "Sign Up": "Cadastrar",
    "Email": "Email",
    "Password": "Senha",
    "Name": "Nome",
    "Date": "Data",
    "Status": "Status",
    "Action": "Ação",
    "Save": "Salvar",
    "Cancel": "Cancelar",
    "Edit": "Editar",
    "Delete": "Excluir",
    "Remove": "Remover",
    "Add": "Adicionar",
    "Create": "Criar",
    "Update": "Atualizar",
    "Close": "Fechar",
    "Open": "Abrir",
    "View": "Ver",
    "Share": "Compartilhar",
    "Copy": "Copiar",
    "Download": "Baixar",
    "Upload": "Enviar",
    "Search": "Buscar",
    "Filter": "Filtrar",
    "Sort": "Ordenar",
    "Back": "Voltar",
    "Next": "Próximo",
    "Finish": "Concluir",
    "Done": "Pronto",
    "Success": "Sucesso",
    "Error": "Erro",
    "Warning": "Aviso",
    "Info": "Info",
    "Loading": "Carregando...",
    "Processing": "Processando...",
    "Analyzing": "Analisando...",
    "Calculating": "Calculando...",
    "Saving": "Salvando...",
    "Deleting": "Excluindo...",
    "Updating": "Atualizando...",
    "Wait": "Aguarde",
    "Yes": "Sim",
    "No": "Não",
    "Maybe": "Talvez",
    "Always": "Sempre",
    "Never": "Nunca",
    "Sometimes": "Às vezes",
    "Day": "Dia",
    "Night": "Noite",
    "Morning": "Manhã",
    "Afternoon": "Tarde",
    "Evening": "Noite",
    "Week": "Semana",
    "Month": "Mês",
    "Year": "Ano",
    "Hour": "Hora",
    "Minute": "Minuto",
    "Second": "Segundo",
    "Now": "Agora",
    "Later": "Depois",
    "Soon": "Em breve",
    "Yesterday": "Ontem",
    "Tomorrow": "Amanhã",
    "Today": "Hoje",
    "Daily": "Diário",
    "Weekly": "Semanal",
    "Monthly": "Mensal",
    "Yearly": "Anual",
    "One-time": "Único",
    "Recurring": "Recorrente",
    "Lifetime": "Vitalício",
    "Free": "Grátis",
    "Paid": "Pago",
    "Premium": "Premium",
    "Pro": "Pro",
    "Basic": "Básico",
    "Advanced": "Avançado",
    "Enterprise": "Empresarial",
    "Trial": "Teste",
    "Subscription": "Assinatura",
    "Plan": "Plano",
    "Billing": "Cobrança",
    "Payment": "Pagamento",
    "Invoice": "Fatura",
    "Receipt": "Recibo",
    "Card": "Cartão",
    "Cash": "Dinheiro",
    "Bank": "Banco",
    "Wallet": "Carteira",
    "Credit": "Crédito",
    "Debit": "Débito",
    "Balance": "Saldo",
    "Currency": "Moeda",
    "Amount": "Valor",
    "Price": "Preço",
    "Cost": "Custo",
    "Discount": "Desconto",
    "Tax": "Imposto",
    "Total": "Total",
    "Subtotal": "Subtotal",
    "Shipping": "Frete",
    "Handling": "Manuseio",
    "Fee": "Taxa",
    "Tip_Money": "Gorjeta",
    "Donation": "Doação",
    "Gift": "Presente",
    "Reward": "Recompensa",
    "Points": "Pontos",
    "Level": "Nível",
    "Rank": "Ranking",
    "Badge": "Emblema",
    "Achievement": "Conquista",
    "Goal": "Objetivo",
    "Target": "Meta",
    "Challenge": "Desafio",
    "Competition": "Competição",
    "Leaderboard": "Placar",
    "Winner": "Vencedor",
    "Loser": "Perdedor",
    "Draw": "Empate",
    "Game": "Jogo",
    "Match": "Partida",
    "Round": "Rodada",
    "Turn": "Turno",
    "Player": "Jogador",
    "Team": "Time",
    "Opponent": "Oponente",
    "Friend": "Amigo",
    "Enemy": "Inimigo",
    "Partner": "Parceiro",
    "Group": "Grupo",
    "Community": "Comunidade",
    "Private": "Privado",
    "Public": "Público",
    "Hidden": "Oculto",
    "Visible": "Visível",
    "Shared": "Compartilhado",
    "Personal": "Pessoal",
    "Official": "Oficial",
    "Unofficial": "Não oficial",
    "Verified": "Verificado",
    "Unverified": "Não verificado",
    "Secure": "Seguro",
    "Insecure": "Inseguro",
    "Safe": "Seguro",
    "Dangerous": "Perigoso",
    "Risk": "Risco",
    "Safety": "Segurança",
    "Security": "Segurança",
    "Privacy": "Privacidade",
    "Policy": "Política",
    "Terms": "Termos",
    "Conditions": "Condições",
    "Agreement": "Acordo",
    "Contract": "Contrato",
    "License": "Licença",
    "Copyright": "Direitos Autorais",
    "Trademark": "Marca Registrada",
    "Patent": "Patente",
    "Legal": "Legal",
    "Illegal": "Ilegal",
    "Compliance": "Conformidade",
    "Regulation": "Regulamentação",
    "Standard": "Padrão",
    "Rule": "Regra",
    "Law": "Lei",
    "Guideline": "Diretriz",
    "Requirement": "Requisito",
    "Restriction": "Restrição",
    "Limitation": "Limitação",
    "Exception": "Exceção",
    "Permission": "Permissão",
    "Authorization": "Autorização",
    "Authentication": "Autenticação", 
    "Confirmation": "Confirmação",
    "Verification": "Verificação",
    "Validation": "Validação",
    "Check": "Verificar", 
    "Test": "Teste", 
    "Trial": "Tentativa",
    "Attempt": "Tentativa",
    "Result": "Resultado", 
    "Outcome": "Desfecho",
    "Effect": "Efeito",
    "Cause": "Causa",
    "Reason": "Razão",
    "Purpose": "Propósito", 
    "Goal_2": "Meta", 
    "Objective": "Objetivo", 
    "Target_2": "Alvo",
    "Mission": "Missão", 
    "Vision": "Visão", 
    "Value": "Valor", 
    "Principle": "Princípio", 
    "Philosophy": "Filosofia", 
    "Concept": "Conceito", 
    "Idea": "Ideia",
    "Theory": "Teoria", 
    "Hypothesis": "Hipótese", 
    "Fact": "Fato", 
    "Evidence": "Evidência",
    "Proof_2": "Prova",
    "Argument": "Argumento", 
    "Opinion": "Opinião",
    "Belief": "Crença",
    "Faith": "Fé",
    "Truth": "Verdade", 
    "Lie": "Mentira", 
    "Myth": "Mito",
    "Legend": "Lenda", 
    "Story": "História", 
    "Tale": "Conto",
    "Narrative": "Narrativa", 
    "Account_2": "Relato",
    "Report": "Relatório",
    "Article": "Artigo",
    "Paper": "Artigo", 
    "Essay": "Ensaio",
    "Book": "Livro",
    "Chapter": "Capítulo",
    "Section": "Seção",
    "Paragraph": "Parágrafo",
    "Sentence": "Frase",
    "Word": "Palavra",
    "Letter": "Letra",
    "Number": "Número",
    "Symbol": "Símbolo",
    "Icon": "Ícone",
    "Image": "Imagem",
    "Picture": "Foto",
    "Photo": "Foto",
    "Video": "Vídeo", 
    "Audio": "Áudio",
    "Music": "Música",
    "Sound": "Som",
    "Noise": "Ruído",
    "Silence": "Silêncio",
    "Voice": "Voz",
    "Speech": "Fala",
    "Language": "Idioma",
    "Text": "Texto",
    "Font": "Fonte",
    "Style": "Estilo",
    "Color": "Cor",
    "Size": "Tamanho",
    "Shape": "Forma",
    "Pattern": "Padrão",
    "Texture": "Textura",
    "Material": "Material",
    "Theme": "Tema",
    "Design": "Design",
    "Layout": "Layout",
    "Format": "Formato",
    "Structure": "Estrutura",
    "System": "Sistema",
    "Process": "Processo",
    "Workflow": "Fluxo de Trabalho",
    "Method": "Método",
    "Technique": "Técnica",
    "Strategy": "Estratégia",
    "Tactic": "Tática",
    "Plan": "Plano",
    "Approach": "Abordagem"
}

COMMON_ES = {
    "Easy": "Fácil",
    "Medium": "Medio",
    "Hard": "Difícil",
    "Expert": "Experto",
    "Mix": "Mezcla",
    "Prep": "Prepara",
    "Bake": "Hornear",
    "Bulk": "Fermentación en Bloque",
    "Proof": "Fermentación Final",
    "Cold": "Frío",
    "Type": "Tipo",
    "Temp": "Temp",
    "Flour": "Harina",
    "Water": "Agua",
    "Salt": "Sal",
    "Yeast": "Levadura",
    "Sugar": "Azúcar",
    "Oil": "Aceite",
    "Fat": "Grasa",
    "Milk": "Leche",
    "Butter": "Mantequilla",
    "Eggs": "Huevos",
    "Egg": "Huevo",
     "Whole Egg": "Huevo Entero",
    "Whole Eggs": "Huevos Enteros",
    "Eggy Wash": "Huevo batido",
    "Sourdough": "Masa Madre",
    "Poolish": "Poolish",
    "Biga": "Biga",
    "Sponge": "Esponja",
    "Autolyse": "Autólisis",
    "Tangzhong": "Tangzhong",
    "Yudane": "Yudane",
    "Pre-ferment": "Prefermento",
    "Leavening": "Fermentación",
    "Direct": "Directo",
    "Indirect": "Indirecto",
    "Hybrid": "Híbrido",
    "USA": "EE. UU.",
    "Italy": "Italia",
    "France": "Francia",
    "Germany": "Alemania",
    "Spain": "España",
    "Brazil": "Brasil",
    "Japan": "Japón",
    "Mexico": "México",
    "China": "China",
    "India": "India",
    "Ireland": "Irlanda",
    "Netherlands": "Países Bajos",
    "Denmark": "Dinamarca",
    "Norway": "Noruega",
    "Europe": "Europa",
    "Asia": "Asia",
    "Global": "Global",
    "Traditional": "Tradicional",
    "Modern": "Moderno",
    "Authentic": "Auténtico",
    "Standard": "Estándar",
    "Classic": "Clásico",
    "Custom": "Personalizado",
    "Unknown": "Desconocido",
    "Balanced": "Equilibrado",
    "Soft": "Suave",
    "Crispy": "Crujiente",
    "Crunchy": "Crocante",
    "Chewy": "Masticable",
    "Dense": "Denso",
    "Light": "Ligero",
    "Airy": "Aireado",
    "High": "Alto",
    "Low": "Bajo",
    "Normal": "Normal",
    "Rich": "Rico",
    "Lean": "Magro",
    "Sweet": "Dulce",
    "Salty": "Salado",
    "Sour": "Agrio",
    "Bitter": "Amargo",
    "Savory": "Sabroso/Salado",
    "Steam": "Vapor",
    "Convection": "Convección",
    "Conduction": "Conducción",
    "Radiant": "Radiante",
    "Lye": "Sosa Cáustica",
    "Breakfast": "Desayuno",
    "Snack": "Merienda",
    "Dinner": "Cena",
    "Lunch": "Almuerzo",
    "Dessert": "Postre",
    "Bread": "Pan",
    "Pizza": "Pizza",
    "Flatbread": "Pan Plano",
    "Pastry": "Pastelería",
    "Bun": "Bollo",
    "Roll": "Rollo",
    "Loaf": "Hogaza",
    "Baguette": "Baguette",
    "Brioche": "Brioche",
    "Croissant": "Croissant",
    "Focaccia": "Focaccia",
    "Panettone": "Panettone",
    "Stollen": "Stollen",
    "Donut": "Dona",
    "Cookie": "Galleta",
    "Cake": "Pastel",
    "Brownie": "Brownie",
    "Pita": "Pita",
    "Naan": "Naan",
    "Tortilla": "Tortilla",
    "Bagel": "Bagel",
    "Pretzel": "Pretzel",
    "Soda Bread": "Pan de Soda",
    "Tiger Bread": "Pan Tigre",
    "Rye": "Centeno",
    "Wheat": "Trigo",
    "Whole Wheat": "Trigo Integral",
    "White": "Blanco",
    "Corn": "Maíz",
    "Potato": "Papa",
    "Rice": "Arroz",
    "Semolina": "Sémola",
    "Durum": "Durum",
    "Spelt": "Espelta",
    "High Gluten": "Alto Gluten",
    "All Purpose": "Todo Uso",
    "Bread Flour": "Harina de Pan",
    "Cake Flour": "Harina de Pastel",
    "Pastry Flour": "Harina de Repostería",
    "Strong": "Fuerte",
    "Weak": "Débil",
    "Active": "Activo",
    "Inactive": "Inactivo",
    "Fresh": "Fresco",
    "Dry": "Seco",
    "Instant": "Instantáneo",
    "Liquid": "Líquido",
    "Solid": "Sólido",
    "History": "Historia",
    "Science": "Ciencia",
    "Origin": "Origen",
    "Description": "Descripción",
    "Instructions": "Instrucciones",
    "Notes": "Notas",
    "Tips": "Consejos",
    "Warnings": "Advertencias", 
    "Ingredients": "Ingredientes",
    "Method": "Método",
    "Process": "Proceso",
    "Time": "Tiempo",
    "Temperature": "Temperatura",
    "Tools": "Herramientas",
    "Equipment": "Equipo",
    "Total": "Total",
    "Yield": "Rendimiento",
    "Servings": "Porciones",
    "Author": "Autor",
    "Source": "Fuente",
    "Reference": "Referencia",
    "None": "Ninguno",
    "Optional": "Opcional",
    "Required": "Requerido",
    "Recommended": "Recomendado",
    "Forbidden": "Prohibido",
    "Ideal": "Ideal",
    "General": "General",
    "Specific": "Específico",
    "Other": "Otro",
    "More": "Más",
    "Less": "Menos",
    "About": "Sobre",
    "Contact": "Contacto",
    "Help": "Ayuda",
    "Settings": "Ajustes",
    "Profile": "Perfil",
    "Account": "Cuenta",
    "Login": "Entrar",
    "Logout": "Salir",
    "Sign Up": "Registrarse",
    "Email": "Correo",
    "Password": "Contraseña",
    "Name": "Nombre",
    "Date": "Fecha",
    "Status": "Estado",
    "Action": "Acción",
    "Save": "Guardar",
    "Cancel": "Cancelar",
    "Edit": "Editar",
    "Delete": "Eliminar",
    "Remove": "Quitar",
    "Add": "Añadir",
    "Create": "Crear",
    "Update": "Actualizar",
    "Close": "Cerrar",
    "Open": "Abrir",
    "View": "Ver",
    "Share": "Compartir",
    "Copy": "Copiar",
    "Download": "Descargar",
    "Upload": "Subir",
    "Search": "Buscar",
    "Filter": "Filtrar",
    "Sort": "Ordenar",
    "Back": "Atrás",
    "Next": "Siguiente",
    "Finish": "Finalizar",
    "Done": "Hecho",
    "Success": "Éxito",
    "Error": "Error",
    "Warning": "Advertencia",
    "Info": "Info",
    "Loading": "Cargando...",
    "Processing": "Procesando...",
    "Analyzing": "Analizando...",
    "Calculating": "Calculando...",
    "Saving": "Guardando...",
    "Deleting": "Eliminando...",
    "Updating": "Actualizando...",
    "Wait": "Espere",
    "Yes": "Sí",
    "No": "No",
    "Maybe": "Tal vez",
    "Always": "Siempre",
    "Never": "Nunca",
    "Sometimes": "A veces",
    "Day": "Día",
    "Night": "Noche",
    "Morning": "Mañana",
    "Afternoon": "Tarde",
    "Evening": "Noche",
    "Week": "Semana",
    "Month": "Mes",
    "Year": "Año",
    "Hour": "Hora",
    "Minute": "Minuto",
    "Second": "Segundo",
    "Now": "Ahora",
    "Later": "Luego",
    "Soon": "Pronto",
    "Yesterday": "Ayer",
    "Tomorrow": "Mañana",
    "Today": "Hoy",
    "Daily": "Diario",
    "Weekly": "Semanal",
    "Monthly": "Mensual",
    "Yearly": "Anual",
    "One-time": "Único",
    "Recurring": "Recurrente",
    "Lifetime": "Vitalicio",
    "Free": "Gratis",
    "Paid": "Pago",
    "Premium": "Premium",
    "Pro": "Pro",
    "Basic": "Básico",
    "Advanced": "Avanzado",
    "Enterprise": "Empresarial",
    "Trial": "Prueba",
    "Subscription": "Suscripción",
    "Plan": "Plan",
    "Billing": "Facturación",
    "Payment": "Pago",
    "Invoice": "Factura",
    "Receipt": "Recibo",
    "Card": "Tarjeta",
    "Cash": "Efectivo",
    "Bank": "Banco",
    "Wallet": "Billetera",
    "Credit": "Crédito",
    "Debit": "Débito",
    "Balance": "Saldo",
    "Currency": "Moneda",
    "Amount": "Cantidad",
    "Price": "Precio",
    "Cost": "Costo",
    "Discount": "Descuento",
    "Tax": "Impuesto",
    "Total": "Total",
    "Subtotal": "Subtotal",
    "Shipping": "Envío",
    "Handling": "Manejo",
    "Fee": "Tarifa",
    "Tip_Money": "Propina",
    "Donation": "Donación",
    "Gift": "Regalo",
    "Reward": "Recompensa",
    "Points": "Puntos",
    "Level": "Nivel",
    "Rank": "Rango",
    "Badge": "Insignia",
    "Achievement": "Logro",
    "Goal": "Objetivo",
    "Target": "Meta",
    "Challenge": "Desafío",
    "Competition": "Competición",
    "Leaderboard": "Tabla",
    "Winner": "Ganador",
    "Loser": "Perdedor",
    "Draw": "Empate",
    "Game": "Juego",
    "Match": "Partido",
    "Round": "Ronda",
    "Turn": "Turno",
    "Player": "Jugador",
    "Team": "Equipo",
    "Opponent": "Oponente",
    "Friend": "Amigo",
    "Enemy": "Enemigo",
    "Partner": "Socio",
    "Group": "Grupo",
    "Community": "Comunidad",
    "Private": "Privado",
    "Public": "Público",
    "Hidden": "Oculto",
    "Visible": "Visible",
    "Shared": "Compartido",
    "Personal": "Personal",
    "Official": "Oficial",
    "Unofficial": "No oficial",
    "Verified": "Verificado",
    "Unverified": "No verificado",
    "Secure": "Seguro",
    "Insecure": "Inseguro",
    "Safe": "Seguro",
    "Dangerous": "Peligroso",
    "Risk": "Riesgo",
    "Safety": "Seguridad",
    "Security": "Seguridad",
    "Privacy": "Privacidad",
    "Policy": "Política",
    "Terms": "Términos",
    "Conditions": "Condiciones",
    "Agreement": "Acuerdo",
    "Contract": "Contrato",
    "License": "Licencia",
    "Copyright": "Derechos de Autor",
    "Trademark": "Marca Registrada",
    "Patent": "Patente",
    "Legal": "Legal",
    "Illegal": "Ilegal",
    "Compliance": "Cumplimiento",
    "Regulation": "Regulación",
    "Standard": "Estándar",
    "Rule": "Regla",
    "Law": "Ley",
    "Guideline": "Directriz",
    "Requirement": "Requisito",
    "Restriction": "Restricción",
    "Limitation": "Limitación",
    "Exception": "Excepción",
    "Permission": "Permiso",
    "Authorization": "Autorización",
    "Authentication": "Autenticación", 
    "Confirmation": "Confirmación",
    "Verification": "Verificación",
    "Validation": "Validación",
    "Check": "Verificar", 
    "Test": "Prueba", 
    "Trial": "Ensayo",
    "Attempt": "Intento",
    "Result": "Resultado", 
    "Outcome": "Resultado",
    "Effect": "Efecto",
    "Cause": "Causa",
    "Reason": "Razón",
    "Purpose": "Propósito", 
    "Goal_2": "Meta", 
    "Objective": "Objetivo", 
    "Target_2": "Objetivo",
    "Mission": "Misión", 
    "Vision": "Visión", 
    "Value": "Valor", 
    "Principle": "Principio", 
    "Philosophy": "Filosofía", 
    "Concept": "Concepto", 
    "Idea": "Idea",
    "Theory": "Teoría", 
    "Hypothesis": "Hipótesis", 
    "Fact": "Hecho", 
    "Evidence": "Evidencia",
    "Proof_2": "Prueba",
    "Argument": "Argumento", 
    "Opinion": "Opinión",
    "Belief": "Creencia",
    "Faith": "Fe",
    "Truth": "Verdad", 
    "Lie": "Mentira", 
    "Myth": "Mito",
    "Legend": "Leyenda", 
    "Story": "Historia", 
    "Tale": "Cuento",
    "Narrative": "Narrativa", 
    "Account_2": "Relato",
    "Report": "Reporte",
    "Article": "Artículo",
    "Paper": "Paper", 
    "Essay": "Ensayo",
    "Book": "Libro",
    "Chapter": "Capítulo",
    "Section": "Sección",
    "Paragraph": "Párrafo",
    "Sentence": "Oración",
    "Word": "Palabra",
    "Letter": "Letra",
    "Number": "Número",
    "Symbol": "Símbolo",
    "Icon": "Ícono",
    "Image": "Imagen",
    "Picture": "Imagen",
    "Photo": "Foto",
    "Video": "Video", 
    "Audio": "Audio",
    "Music": "Música",
    "Sound": "Sonido",
    "Noise": "Ruido",
    "Silence": "Silencio",
    "Voice": "Voz",
    "Speech": "Habla",
    "Language": "Idioma",
    "Text": "Texto",
    "Font": "Fuente",
    "Style": "Estilo",
    "Color": "Color",
    "Size": "Tamaño",
    "Shape": "Forma",
    "Pattern": "Patrón",
    "Texture": "Textura",
    "Material": "Material",
    "Theme": "Tema",
    "Design": "Diseño",
    "Layout": "Diseño",
    "Format": "Formato",
    "Structure": "Estructura",
    "System": "Sistema",
    "Process": "Proceso",
    "Workflow": "Flujo",
    "Method": "Método",
    "Technique": "Técnica",
    "Strategy": "Estrategia",
    "Tactic": "Táctica",
    "Plan": "Plan",
    "Approach": "Enfoque"
}

def translate_value(val, common_dict):
    # Try exact match first
    if val in common_dict:
        return common_dict[val]
    
    # Try case insensitive
    for k, v in common_dict.items():
        if k.lower() == val.lower():
            return v
    
    # Try stripping punctuation or extra spaces
    cleaned = val.strip().rstrip('.').rstrip(':')
    for k, v in common_dict.items():
        if k.lower() == cleaned.lower():
            return v
            
    return val # Return original if no match

def process_file(lang, common_dict):
    path = os.path.join(os.getcwd(), 'public', 'locales', lang, 'calculator.json')
    if not os.path.exists(path):
        print(f"File not found: {path}, skipping.")
        return

    data = load_json(path)
    en_path = os.path.join(os.getcwd(), 'public', 'locales', 'en', 'calculator.json')
    en_data = load_json(en_path)

    # Flatten both to compare and find missing translations (or English values)
    # Actually, we can just walk the EN data and update LANG data if it looks English or is missing.
    
    def walk_and_update(en_node, lang_node):
        modified = False
        for k, v in en_node.items():
            if k not in lang_node:
                # If missing, we create it
                if isinstance(v, dict):
                    lang_node[k] = {}
                    walk_and_update(v, lang_node[k])
                else:
                    # Translate scalar
                    lang_node[k] = translate_value(v, common_dict)
                modified = True
            else:
                # Key exists
                if isinstance(v, dict):
                    if isinstance(lang_node[k], dict):
                        if walk_and_update(v, lang_node[k]):
                            modified = True
                else:
                    # Scalar. Check if it looks English (match EN value)
                    if lang_node[k] == v:
                        # Attempt translation
                        new_val = translate_value(v, common_dict)
                        if new_val != v:
                           lang_node[k] = new_val
                           modified = True
                        
                        # Special handling for repeated keys ending in _NUMBER
                        # e.g. medium_45 -> check if "Medium" maps to something
                        match = re.match(r"^([a-zA-Z_]+)_\d+$", k)
                        if match:
                             base_key = match.group(1)
                             # Try to find base key in en_node (might be tricky if at same level)
                             # But we can try to translate the VALUE itself using the dict
                             pass 

        return modified

    if walk_and_update(en_data, data):
        print(f"Updating {lang} calculator.json...")
        save_json(path, data)
    else:
        print(f"No changes for {lang} calculator.json.")

if __name__ == "__main__":
    print("Processing PT...")
    process_file('pt', COMMON_PT)
    print("Processing ES...")
    process_file('es', COMMON_ES)
